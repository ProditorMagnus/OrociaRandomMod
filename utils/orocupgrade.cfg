#textdomain wesnoth-OrociaRandomMod

#define OROCIARM_SHOW_UPGRADETYPE TXT COLOR
    [if]
        [variable]
            name=side_number
            equals=1
        [/variable]
        [then]
        [/then]
        [else]
            [print]
                text={TXT}
                size=32
                duration=500
                red,green,blue={COLOR}
            [/print]
        [/else]
    [/if]
#enddef

#define OROCIARM_READ_SHRINE_LOCATIONS
    # Reads all stoney fields on map ("R") and store it
    # in: -
    # out: SHRINE_ARRAY (globale variable)

    [store_locations]
        x=1-24
        y=1-24
        terrain=Rr
        variable=shrine_array
    [/store_locations]
#enddef

#define OROCIARM_ALLIED_TENT X Y
    [event]
        name=turn 2
        {IF_VAR OROCIARM_ALLIEDTENT equals yes (
            [then]
                [item]
                    x={X}
                    y={Y}
                    image=scenery/tent-fancy-red.png
                [/item]
            [/then]
        )}
    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            side=2,3,4,5
            x={X}
            y={Y}
        [/filter]
        # IF_VAR doesnt work for this case
        [if]
            [variable]
                name=OROCIARM_ALLIEDTENT
                equals=yes
            [/variable]
            [then]
                [if]
                    [variable]
                        name=AGELESSWAVES
                        equals=yes
                    [/variable]
                    [then]
						[switch]
							variable=side_number
							[case]
								value=2
								[lua]
									code=randomUnit(level_two,{X},{Y},2)
								[/lua]
								[lua]
									code=randomUnit(level_two,{X},{Y},2)
								[/lua]
							[/case]
							[case]
								value=3
								[lua]
									code=randomUnit(level_two,{X},{Y},3)
								[/lua]
								[lua]
									code=randomUnit(level_two,{X},{Y},3)
								[/lua]
							[/case]
							[case]
								value=4
								[lua]
									code=randomUnit(level_two,{X},{Y},4)
								[/lua]
								[lua]
									code=randomUnit(level_two,{X},{Y},4)
								[/lua]
							[/case]
							[case]
								value=5
								[lua]
									code=randomUnit(level_two,{X},{Y},5)
								[/lua]
								[lua]
									code=randomUnit(level_two,{X},{Y},5)
								[/lua]
							[/case]
						[/switch]
                    [/then]
                    [else]
                        [chat]
                            message=_"Not available without ageless waves for code efficiency reasons, this might change in later updates. If you wish this be avaliable sooner then pm Ravana with list formated like http://pastebin.com/VNMDQUfy"
                        [/chat]
                    [/else]
                [/if]
                [remove_item]
                    x={X}
                    y={Y}
                    image=scenery/tent-fancy-red.png
                [/remove_item]
            [/then]
        [/if]
    [/event]
#enddef

#define OROCIARM_WEAPON_ARSENAL X Y
    [event]
        name=turn 2

        {IF_VAR OROCIARM_ARSENAL equals yes (
            [then]
                {IF_VAR ronsmap equals no(
                    [then]
                        [item]
                            x={X}
                            y={Y}
                            image=scenery/tent-shop-weapons.png
                        [/item]
                        {VARIABLE arsenal{X}a{Y}a2 0}
                        {VARIABLE arsenal{X}a{Y}a3 0}
                        {VARIABLE arsenal{X}a{Y}a4 0}
                    [/then]
                    [else]
                        {OROCIARM_WEAPON_TENT 10 15 1}
                        {OROCIARM_WEAPON_TENT 19 14 2}
                        {OROCIARM_WEAPON_TENT 13 8 3}
                    [/else]
                )}
            [/then]
        )}
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=2,3,4
            x={X}
            y={Y}
        [/filter]

        {IF_VAR OROCIARM_ARSENAL equals yes (
            [then]
                [if]
                    [variable]
                        name=arsenal{X}a{Y}a$side_number
                        equals=1
                    [/variable]
                    [then]
                        [message]
                            speaker=narrator
                            message= _ "You already visited weapon arsenal (only one weapon available for each player from each arsenal)."
                            image=scenery/tent-shop-weapons.png
                        [/message]
                    [/then]

                    [else]
                        [message]
                            id=ARSENAL0
                            speaker=narrator
                            message= _ "You have come across a weapon arsenal (only one weapon for each player from each arsenal). What would you like to have?"
                            image=scenery/tent-shop-weapons.png
                            [option]
                                id=ARSENAL1
                                message= _ "Daffodils Sword of Light: 12-3 Melee Arcane Magic"

                                [command]
                                    {VARIABLE arsenal{X}a{Y}a$side_number 1}
                                    [object]
                                        silent=yes
                                        duration=forever

                                        [effect]
                                            apply_to=new_attack
                                            name= _ "Daffodils Sword"
                                            icon=attacks/sword-holy.png

                                            type=arcane
                                            range=melee
                                            damage=12
                                            number=3
                                            [specials]
                                                {WEAPON_SPECIAL_MAGICAL}
                                            [/specials]
                                        [/effect]

                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Daffodils Sword"
                                                [/filter_attack]
                                                hits=no

                                                [frame]
                                                    begin=-200
                                                    end=-150
                                                [/frame]

                                                [frame]
                                                    begin=-150
                                                    end=100
                                                [/frame]

                                                [frame]
                                                    begin=100
                                                    end=200
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Daffodils Sword"
                                                [/filter_attack]
                                                hits=yes

                                                [frame]
                                                    begin=-200
                                                    end=-150
                                                [/frame]

                                                [frame]
                                                    begin=-150
                                                    end=70
                                                [/frame]

                                                [frame]
                                                    begin=100
                                                    end=200
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                    [/object]
                                [/command]
                            [/option]

                            [option]
                                id=ARSENAL1
                                message= _ "Tylers Sword of Darkness: 10-3 Melee Blade Drain"

                                [command]
                                    {VARIABLE arsenal{X}a{Y}a$side_number 1}
                                    [object]
                                        silent=yes
                                        duration=forever

                                        [effect]
                                            apply_to=new_attack
                                            name= _ "Tylers Sword"
                                            icon=attacks/sword-holy.png

                                            type=blade
                                            range=melee
                                            damage=10
                                            number=3
                                            [specials]
                                                {WEAPON_SPECIAL_DRAIN}
                                            [/specials]
                                        [/effect]

                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Tylers Sword"
                                                [/filter_attack]
                                                hits=no

                                                [frame]
                                                    begin=-200
                                                    end=-150
                                                [/frame]

                                                [frame]
                                                    begin=-150
                                                    end=100
                                                [/frame]

                                                [frame]
                                                    begin=100
                                                    end=200
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Tylers Sword"
                                                [/filter_attack]
                                                hits=yes

                                                [frame]
                                                    begin=-200
                                                    end=-150
                                                [/frame]

                                                [frame]
                                                    begin=-150
                                                    end=70
                                                [/frame]

                                                [frame]
                                                    begin=100
                                                    end=200
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                    [/object]
                                [/command]
                            [/option]

                            [option]
                                id=ARSENAL3
                                message= _ "Gods Balls of Death: 12-3 Ranged Fire Magical"
                                [command]
                                    {VARIABLE arsenal{X}a{Y}a$side_number 1}
                                    [object]
                                        silent=yes
                                        duration=forever
                                        [effect]
                                            apply_to=new_attack
                                            name= _ "Gods Balls of Death"
                                            icon=attacks/fireball.png
                                            type=fire
                                            range=ranged
                                            [specials]
                                                {WEAPON_SPECIAL_MAGICAL}
                                            [/specials]
                                            damage=12
                                            number=3
                                        [/effect]
                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Gods Balls of Death"
                                                [/filter_attack]
                                                {MISSILE_FRAME_FIREBALL}
                                                [frame]
                                                    begin=-240
                                                    end=-200
                                                [/frame]

                                                [frame]
                                                    begin=-200
                                                    end=-180
                                                [/frame]

                                                [frame]
                                                    begin=-180
                                                    end=-120
                                                    #halo=halo/fireball-preparation-1.png,halo/fireball-preparation-2.png
                                                    #halo_x,halo_y=-11,3
                                                    sound=fire.wav
                                                [/frame]

                                                [frame]
                                                    begin=-120
                                                    end=-60
                                                    #halo=halo/fireball-preparation-3.png,halo/fireball-preparation-4.png
                                                    #halo_x,halo_y=-15,1
                                                [/frame]

                                                [frame]
                                                    begin=-60
                                                    end=0
                                                    #halo=halo/fireball-preparation-5.png,halo/fireball-preparation-6.png
                                                    #halo_x,halo_y=-11,3
                                                [/frame]

                                                [frame]
                                                    begin=0
                                                    end=60
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                    [/object]
                                [/command]
                            [/option]

                            [option]
                                id=ARSENAL4
                                message= _ "Oceans Wave of Darkness: 10-3 Ranged Cold Drain"
                                [command]
                                    {VARIABLE arsenal{X}a{Y}a$side_number 1}
                                    [object]
                                        silent=yes
                                        duration=forever
                                        [effect]
                                            apply_to=new_attack
                                            name= _ "Oceans Wave"
                                            icon=attacks/dark-missile.png
                                            type=cold
                                            range=ranged

                                            [specials]
                                                {WEAPON_SPECIAL_DRAIN}
                                            [/specials]

                                            damage=10
                                            number=3
                                        [/effect]
                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Oceans Wave"
                                                [/filter_attack]
                                                hits=yes
                                                [missile_frame]
                                                    begin=-200
                                                    end=0
                                                    image="projectiles/darkmissile-n.png"
                                                    image_diagonal="projectiles/darkmissile-ne.png"
                                                [/missile_frame]

                                                [frame]
                                                    begin=-250
                                                    end=-180
                                                    sound=magic-dark.ogg
                                                [/frame]

                                                [frame]
                                                    begin=-180
                                                    end=-70
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                        [effect]
                                            apply_to=new_animation
                                            [attack_anim]
                                                [filter_attack]
                                                    name=_ "Oceans Wave"
                                                [/filter_attack]
                                                hits=no

                                                [missile_frame]
                                                    begin=-200
                                                    end=0
                                                    image="projectiles/darkmissile-n.png"
                                                    image_diagonal="projectiles/darkmissile-ne.png"
                                                [/missile_frame]

                                                [frame]
                                                    begin=-250
                                                    end=-180
                                                    sound=magic-dark-miss.ogg
                                                [/frame]

                                                [frame]
                                                    begin=-130
                                                    end=-70
                                                [/frame]
                                            [/attack_anim]
                                        [/effect]
                                    [/object]
                                [/command]
                            [/option]

                            [option]
                                id=ARSENAL10
                                message= _ "Don't take anyhing."
                                [command]
                                [/command]
                            [/option]
                        [/message]
                    [/else]
                [/if]
            [/then]
        )}
    [/event]
#enddef

#define OROCUPGRADE
    [event]
        name=side turn
        first_time_only=no
        [filter_condition]
            [variable]
                name=INDIVIDUAL
                equals=no
            [/variable]
        [/filter_condition]
        [if]
            [variable]
                name=INDIVIDUAL
                equals=no
            [/variable]
            [then]
                [if]
                    [variable]
                        name=turn_number
                        equals=1
                    [/variable]
                    [then]
                    [/then]
                    [else]
                        [switch]
                            variable=upgrade
                            [case]
                                value=1
                                [switch]
                                    variable=randomless
                                    [case]
                                        value=1
                                        {OROCIARM_SHOW_UPGRADETYPE (_"hitpoints") 0,176,0}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase_total=$hp_value
                                                [/effect]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase=$hp_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                        [if]
                                            [variable]
                                                name=side_number
                                                equals=1
                                            [/variable]
                                            [then]
                                            [/then]
                                            [else]
                                                [set_variable]
                                                    name=randomless
                                                    add=1
                                                [/set_variable]
                                            [/else]
                                        [/if]
                                    [/case]
                                    [case]
                                        value=2
                                        {OROCIARM_SHOW_UPGRADETYPE (_"damage") (0,127,255)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_damage=$damage_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                        [if]
                                            [variable]
                                                name=side_number
                                                equals=1
                                            [/variable]
                                            [then]
                                            [/then]
                                            [else]
                                                [set_variable]
                                                    name=randomless
                                                    add=1
                                                [/set_variable]
                                            [/else]
                                        [/if]
                                    [/case]
                                    [case]
                                        value=3
                                        {OROCIARM_SHOW_UPGRADETYPE (_"movement") (180,0,180)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=movement
                                                    increase=$move_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                        [if]
                                            [variable]
                                                name=side_number
                                                equals=1
                                            [/variable]
                                            [then]
                                            [/then]
                                            [else]
                                                [set_variable]
                                                    name=randomless
                                                    add=1
                                                [/set_variable]
                                            [/else]
                                        [/if]
                                    [/case]
                                    [case]
                                        value=4
                                        {OROCIARM_SHOW_UPGRADETYPE (_"resistance") (255,128,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=resistance
                                                    replace=no
                                                    [resistance]
                                                        arcane=-$res_value
                                                        fire=-$res_value
                                                        blade=-$res_value
                                                        pierce=-$res_value
                                                        impact=-$res_value
                                                        cold=-$res_value
                                                    [/resistance]
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                        [if]
                                            [variable]
                                                name=side_number
                                                equals=1
                                            [/variable]
                                            [then]
                                            [/then]
                                            [else]
                                                [set_variable]
                                                    name=randomless
                                                    value=1
                                                [/set_variable]
                                            [/else]
                                        [/if]
                                    [/case]
                                [/switch]
                            [/case]

                            [case]
                                value=2
                                [set_variable]
                                    name=randupgrade
                                    rand=1..7
                                [/set_variable]
                                [switch]
                                    variable=randupgrade
                                    [case]
                                        value=1
                                        {OROCIARM_SHOW_UPGRADETYPE (_"resistance") (255,128,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=resistance
                                                    replace=no
                                                    [resistance]
                                                        arcane=-$res_value
                                                        fire=-$res_value
                                                        blade=-$res_value
                                                        pierce=-$res_value
                                                        impact=-$res_value
                                                        cold=-$res_value
                                                    [/resistance]
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=2
                                        {OROCIARM_SHOW_UPGRADETYPE (_"hitpoints") (0,176,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase_total=$hp_value
                                                [/effect]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase=$hp_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=3
                                        {OROCIARM_SHOW_UPGRADETYPE (_"damage") (0,127,255)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_damage=$damage_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=4
                                        {OROCIARM_SHOW_UPGRADETYPE (_"movement") (180,0,180)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=movement
                                                    increase=$move_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=5
                                        {OROCIARM_SHOW_UPGRADETYPE (_"strike") (74,247,187)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_attacks=$attack_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=6
                                        {OROCIARM_SHOW_UPGRADETYPE (_"nothing") (255,255,0)}
                                    [/case]
                                    [case]
                                        value=7
                                        {OROCIARM_SHOW_UPGRADETYPE (_"nothing") (255,255,0)}
                                    [/case]
                                [/switch]
                            [/case]

                            [case]
                                value=3
                                [set_variable]
                                    name=randupgrade
                                    rand=1..7
                                [/set_variable]
                                [switch]
                                    variable=randupgrade
                                    [case]
                                        value=1
                                        {OROCIARM_SHOW_UPGRADETYPE (_"resistance") (255,128,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=resistance
                                                    replace=no
                                                    [resistance]
                                                        arcane=-$res_value
                                                        fire=-$res_value
                                                        blade=-$res_value
                                                        pierce=-$res_value
                                                        impact=-$res_value
                                                        cold=-$res_value
                                                    [/resistance]
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=2
                                        {OROCIARM_SHOW_UPGRADETYPE (_"hitpoints") (0,176,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase_total=$hp_value
                                                [/effect]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase=$hp_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=3
                                        {OROCIARM_SHOW_UPGRADETYPE (_"damage") (0,127,255)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_damage=$damage_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=4
                                        {OROCIARM_SHOW_UPGRADETYPE (_"movement") (180,0,180)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=movement
                                                    increase=$move_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=5
                                        {OROCIARM_SHOW_UPGRADETYPE (_"strike") (74,247,187)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_attacks=$attack_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=6
                                        {OROCIARM_SHOW_UPGRADETYPE (_"zonk!") (255,0,0)}
                                        [set_variable]
                                            name=randzonk
                                            rand=1..2
                                        [/set_variable]
                                        [switch]
                                            variable=randzonk
                                            [case]
                                                value=1
                                                {FOREACH shrine_array i}
                                                    [object]
                                                        silent=yes
                                                        [filter]
                                                            x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                            side=$side_number
                                                        [/filter]
                                                        [effect]
                                                            apply_to=attack
                                                            increase_attacks=-$zonk_attack
                                                        [/effect]
                                                    [/object]
                                                {NEXT i}
                                            [/case]
                                            [case]
                                                value=2
                                                {FOREACH shrine_array i}
                                                    [object]
                                                        silent=yes
                                                        [filter]
                                                            x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                            side=$side_number
                                                        [/filter]
                                                        [effect]
                                                            apply_to=attack
                                                            increase_damage=-$zonk_damage
                                                        [/effect]
                                                    [/object]
                                                {NEXT i}
                                            [/case]
                                        [/switch]
                                    [/case]
                                    [case]
                                        value=7
                                        {OROCIARM_SHOW_UPGRADETYPE (_"nothing") (255,255,0)}
                                    [/case]
                                [/switch]
                            [/case]

                            [case]
                                value=4
                                [set_variable]
                                    name=randupgrade
                                    rand=1..7
                                [/set_variable]
                                [switch]
                                    variable=randupgrade
                                    [case]
                                        value=1
                                        {OROCIARM_SHOW_UPGRADETYPE (_"resistance") (255,128,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=resistance
                                                    replace=no
                                                    [resistance]
                                                        arcane=-$res_value
                                                        fire=-$res_value
                                                        blade=-$res_value
                                                        pierce=-$res_value
                                                        impact=-$res_value
                                                        cold=-$res_value
                                                    [/resistance]
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=2
                                        {OROCIARM_SHOW_UPGRADETYPE (_"hitpoints") (0,176,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase_total=$hp_value
                                                [/effect]
                                                [effect]
                                                    apply_to=hitpoints
                                                    increase=$hp_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=3
                                        {OROCIARM_SHOW_UPGRADETYPE (_"damage") (0,127,255)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_damage=$damage_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=4
                                        {OROCIARM_SHOW_UPGRADETYPE (_"movement") (180,0,180)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=movement
                                                    increase=$move_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=5
                                        {OROCIARM_SHOW_UPGRADETYPE (_"strike") (74,247,187)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=attack
                                                    increase_attacks=$attack_value
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                    [case]
                                        value=6
                                        {OROCIARM_SHOW_UPGRADETYPE (_"zonk!") (255,0,0)}
                                        [set_variable]
                                            name=randzonk
                                            rand=1..2
                                        [/set_variable]
                                        [switch]
                                            variable=randzonk
                                            [case]
                                                value=1
                                                {FOREACH shrine_array i}
                                                    [object]
                                                        silent=yes
                                                        [filter]
                                                            x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                            side=$side_number
                                                        [/filter]
                                                        [effect]
                                                            apply_to=attack
                                                            increase_attacks=-$zonk_attack
                                                        [/effect]
                                                    [/object]
                                                {NEXT i}
                                            [/case]
                                            [case]
                                                value=2
                                                {FOREACH shrine_array i}
                                                    [object]
                                                        silent=yes
                                                        [filter]
                                                            x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                            side=$side_number
                                                        [/filter]
                                                        [effect]
                                                            apply_to=attack
                                                            increase_damage=-$zonk_damage
                                                        [/effect]
                                                    [/object]
                                                {NEXT i}
                                            [/case]
                                        [/switch]
                                    [/case]

                                    [case]
                                        value=7
                                        {OROCIARM_SHOW_UPGRADETYPE (_"defense") (0,90,0)}
                                        {FOREACH shrine_array i}
                                            [object]
                                                silent=yes
                                                [filter]
                                                    x,y=$shrine_array[$i].x,$shrine_array[$i].y
                                                    side=$side_number
                                                [/filter]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        deep_water=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        shallow_water=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        swamp_water=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        flat=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        sand=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        forest=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        hills=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        mountains=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        village=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        castle=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        cave=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        frozen=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        unwalkable=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        impassable=-$def_value
                                                    [/defense]
                                                [/effect]
                                                [effect]
                                                    apply_to=defense
                                                    replace=no
                                                    [defense]
                                                        fungus=-$def_value
                                                    [/defense]
                                                [/effect]
                                            [/object]
                                        {NEXT i}
                                    [/case]
                                [/switch]
                            [/case]
                        [/switch]
                    [/else]
                [/if]
            [/then]
        [/if]
    [/event]
#enddef
